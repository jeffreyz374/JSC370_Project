gretzky_data_copy$Result == "OTL" ~ "Overtime Loss",
gretzky_data_copy$Result == "T" ~ "Tie")
gretzky_data_copy$HomeAway <- case_when(gretzky_data_copy$HomeAway == "H" ~ "Home", gretzky_data_copy$HomeAway == "A" ~ "Away")
gretzky_data_copy$Strength <- case_when(gretzky_data_copy$Strength == "EV" ~ "Even Strength", gretzky_data_copy$Strength == "PP" ~ "Power Play", gretzky_data_copy$Strength == "SH" ~ "Shorthanded")
gretzky_data_copy$Time <- substr(gretzky_data_copy$Time, start = 12, stop = 16)
gretzky_data_copy$Team <- case_when(gretzky_data_copy$Team == "EDM" ~ "Edmonton Oilers",
gretzky_data_copy$Team == "LAK" ~ "Los Angeles Kings",
gretzky_data_copy$Team == "STL" ~ "St. Louis Blues",
gretzky_data_copy$Team == "NYR" ~ "New York Rangers")
gretzky_data_copy <- merge(gretzky_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
gretzky_data_copy <- gretzky_data_copy[c(2:ncol(gretzky_data_copy))]
colnames(gretzky_data_copy) <- c("Date", "Team", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Result", "Home/Away", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
gretzky_data_copy <- gretzky_data_copy[, c(1, 2, 15, 3:10, 12, 11, 13, 14)]
gretzky_data_copy <- left_join(gretzky_data_copy, gretzky_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
gretzky_data_copy <- gretzky_data_copy[, c(1:13, 18, 14:15)]
colnames(gretzky_data_copy) <- c("Date", "Team", "Opponent", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
gretzky_data_copy <- gretzky_data_copy %>%
arrange(desc(Date))
gretzky_data_copy$cgoal <- rev(c(1:894))
gretzky_data_copy <- gretzky_data_copy[, c(1:4, 17, 5:16)]
colnames(gretzky_data_copy) <- c("Date", "Team", "Opponent", "Age", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_data_copy %>% arrange(desc(Date, Period))
ovi_data_copy <- ovi_data
ovi_data_copy[is.na(ovi_data_copy)] <- "N/A"
ovi_data_copy$PS <- case_when(ovi_data_copy$PS == 0 ~ "No", ovi_data_copy$PS == 1 ~ "Yes")
ovi_data_copy$ENG <- case_when(ovi_data_copy$ENG == 0 ~ "No", ovi_data_copy$ENG == 1 ~ "Yes")
ovi_data_copy$Result <- case_when(ovi_data_copy$Result == "W" ~ "Regulation Win",
ovi_data_copy$Result == "L" ~ "Regulation Loss",
ovi_data_copy$Result == "OTW" ~ "Overtime Win",
ovi_data_copy$Result == "OTL" ~ "Overtime Loss",
ovi_data_copy$Result == "SOW" ~ "Shootout Win",
ovi_data_copy$Result == "SOL" ~ "Shootout Loss")
ovi_data_copy$HomeAway <- case_when(ovi_data_copy$HomeAway == "H" ~ "Home", ovi_data_copy$HomeAway == "A" ~ "Away")
ovi_data_copy$Strength <- case_when(ovi_data_copy$Strength == "EV" ~ "Even Strength", ovi_data_copy$Strength == "PP" ~ "Power Play", ovi_data_copy$Strength == "SH" ~ "Shorthanded")
ovi_data_copy$Time <- substr(ovi_data_copy$Time, start = 1, stop = 5)
ovi_data_copy$Team <- rep("Washington Capitals", nrow(ovi_data_copy))
ovi_data_copy <- merge(ovi_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
ovi_data_copy <- ovi_data_copy[c(2:ncol(ovi_data_copy))]
colnames(ovi_data_copy) <- c("Date", "Team", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
ovi_data_copy <- ovi_data_copy[, c(1, 2, 15, 3:14)]
ovi_data_copy <- left_join(ovi_data_copy, ovi_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
ovi_data_copy <- ovi_data_copy[, c(1:13, 18, 14:15)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_data_copy <- ovi_data_copy %>%
arrange(desc(Date))
ovi_data_copy$cgoal <- rev(c(1:776))
ovi_data_copy <- ovi_data_copy[, c(1:4, 17, 5:16)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
"01:00" > "02:00"
ovi_data_copy <- ovi_data
ovi_data_copy[is.na(ovi_data_copy)] <- "N/A"
ovi_data_copy$PS <- case_when(ovi_data_copy$PS == 0 ~ "No", ovi_data_copy$PS == 1 ~ "Yes")
ovi_data_copy$ENG <- case_when(ovi_data_copy$ENG == 0 ~ "No", ovi_data_copy$ENG == 1 ~ "Yes")
ovi_data_copy$Result <- case_when(ovi_data_copy$Result == "W" ~ "Regulation Win",
ovi_data_copy$Result == "L" ~ "Regulation Loss",
ovi_data_copy$Result == "OTW" ~ "Overtime Win",
ovi_data_copy$Result == "OTL" ~ "Overtime Loss",
ovi_data_copy$Result == "SOW" ~ "Shootout Win",
ovi_data_copy$Result == "SOL" ~ "Shootout Loss")
ovi_data_copy$HomeAway <- case_when(ovi_data_copy$HomeAway == "H" ~ "Home", ovi_data_copy$HomeAway == "A" ~ "Away")
ovi_data_copy$Strength <- case_when(ovi_data_copy$Strength == "EV" ~ "Even Strength", ovi_data_copy$Strength == "PP" ~ "Power Play", ovi_data_copy$Strength == "SH" ~ "Shorthanded")
ovi_data_copy$Time <- substr(ovi_data_copy$Time, start = 1, stop = 5)
ovi_data_copy$Team <- rep("Washington Capitals", nrow(ovi_data_copy))
ovi_data_copy <- merge(ovi_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
ovi_data_copy <- ovi_data_copy[c(2:ncol(ovi_data_copy))]
colnames(ovi_data_copy) <- c("Date", "Team", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
ovi_data_copy <- ovi_data_copy[, c(1, 2, 15, 3:14)]
ovi_data_copy <- left_join(ovi_data_copy, ovi_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
ovi_data_copy <- ovi_data_copy[, c(1:13, 18, 14:15)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_data_copy <- ovi_data_copy %>%
arrange(desc(Date, Period, Time))
ovi_data_copy$cgoal <- rev(c(1:776))
ovi_data_copy <- ovi_data_copy[, c(1:4, 17, 5:16)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_data_copy <- ovi_data
ovi_data_copy[is.na(ovi_data_copy)] <- "N/A"
ovi_data_copy$PS <- case_when(ovi_data_copy$PS == 0 ~ "No", ovi_data_copy$PS == 1 ~ "Yes")
ovi_data_copy$ENG <- case_when(ovi_data_copy$ENG == 0 ~ "No", ovi_data_copy$ENG == 1 ~ "Yes")
ovi_data_copy$Result <- case_when(ovi_data_copy$Result == "W" ~ "Regulation Win",
ovi_data_copy$Result == "L" ~ "Regulation Loss",
ovi_data_copy$Result == "OTW" ~ "Overtime Win",
ovi_data_copy$Result == "OTL" ~ "Overtime Loss",
ovi_data_copy$Result == "SOW" ~ "Shootout Win",
ovi_data_copy$Result == "SOL" ~ "Shootout Loss")
ovi_data_copy$HomeAway <- case_when(ovi_data_copy$HomeAway == "H" ~ "Home", ovi_data_copy$HomeAway == "A" ~ "Away")
ovi_data_copy$Strength <- case_when(ovi_data_copy$Strength == "EV" ~ "Even Strength", ovi_data_copy$Strength == "PP" ~ "Power Play", ovi_data_copy$Strength == "SH" ~ "Shorthanded")
ovi_data_copy$Time <- substr(ovi_data_copy$Time, start = 1, stop = 5)
ovi_data_copy$Team <- rep("Washington Capitals", nrow(ovi_data_copy))
ovi_data_copy <- merge(ovi_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
ovi_data_copy <- ovi_data_copy[c(2:ncol(ovi_data_copy))]
colnames(ovi_data_copy) <- c("Date", "Team", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
ovi_data_copy <- ovi_data_copy[, c(1, 2, 15, 3:14)]
ovi_data_copy <- left_join(ovi_data_copy, ovi_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
ovi_data_copy <- ovi_data_copy[, c(1:13, 18, 14:15)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_data_copy <- ovi_data_copy %>%
arrange(desc(Date), Period, desc(Time))
ovi_data_copy$cgoal <- rev(c(1:776))
ovi_data_copy <- ovi_data_copy[, c(1:4, 17, 5:16)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
gretzky_data_copy <- gretzky_data
gretzky_data_copy[is.na(gretzky_data_copy)] <- "N/A"
gretzky_data_copy$PS <- case_when(gretzky_data_copy$PS == 0 ~ "No", gretzky_data_copy$PS == 1 ~ "Yes")
gretzky_data_copy$ENG <- case_when(gretzky_data_copy$ENG == 0 ~ "No", gretzky_data_copy$ENG == 1 ~ "Yes")
gretzky_data_copy$Result <- case_when(gretzky_data_copy$Result == "W" ~ "Regulation Win",
gretzky_data_copy$Result == "L" ~ "Regulation Loss",
gretzky_data_copy$Result == "OTW" ~ "Overtime Win",
gretzky_data_copy$Result == "OTL" ~ "Overtime Loss",
gretzky_data_copy$Result == "T" ~ "Tie")
gretzky_data_copy$HomeAway <- case_when(gretzky_data_copy$HomeAway == "H" ~ "Home", gretzky_data_copy$HomeAway == "A" ~ "Away")
gretzky_data_copy$Strength <- case_when(gretzky_data_copy$Strength == "EV" ~ "Even Strength", gretzky_data_copy$Strength == "PP" ~ "Power Play", gretzky_data_copy$Strength == "SH" ~ "Shorthanded")
gretzky_data_copy$Time <- substr(gretzky_data_copy$Time, start = 12, stop = 16)
gretzky_data_copy$Team <- case_when(gretzky_data_copy$Team == "EDM" ~ "Edmonton Oilers",
gretzky_data_copy$Team == "LAK" ~ "Los Angeles Kings",
gretzky_data_copy$Team == "STL" ~ "St. Louis Blues",
gretzky_data_copy$Team == "NYR" ~ "New York Rangers")
gretzky_data_copy <- merge(gretzky_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
gretzky_data_copy <- gretzky_data_copy[c(2:ncol(gretzky_data_copy))]
colnames(gretzky_data_copy) <- c("Date", "Team", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Result", "Home/Away", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
gretzky_data_copy <- gretzky_data_copy[, c(1, 2, 15, 3:10, 12, 11, 13, 14)]
gretzky_data_copy <- left_join(gretzky_data_copy, gretzky_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
gretzky_data_copy <- gretzky_data_copy[, c(1:13, 18, 14:15)]
colnames(gretzky_data_copy) <- c("Date", "Team", "Opponent", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
gretzky_data_copy <- gretzky_data_copy %>%
arrange(desc(Date), Period, desc(Time))
gretzky_data_copy$cgoal <- rev(c(1:894))
gretzky_data_copy <- gretzky_data_copy[, c(1:4, 17, 5:16)]
colnames(gretzky_data_copy) <- c("Date", "Team", "Opponent", "Age", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
arrange(mtcars, cyl, disp)
arrange(mtcars, desc(cyl), disp)
ovi_data_copy <- ovi_data
ovi_data_copy[is.na(ovi_data_copy)] <- "N/A"
ovi_data_copy$PS <- case_when(ovi_data_copy$PS == 0 ~ "No", ovi_data_copy$PS == 1 ~ "Yes")
ovi_data_copy$ENG <- case_when(ovi_data_copy$ENG == 0 ~ "No", ovi_data_copy$ENG == 1 ~ "Yes")
ovi_data_copy$Result <- case_when(ovi_data_copy$Result == "W" ~ "Regulation Win",
ovi_data_copy$Result == "L" ~ "Regulation Loss",
ovi_data_copy$Result == "OTW" ~ "Overtime Win",
ovi_data_copy$Result == "OTL" ~ "Overtime Loss",
ovi_data_copy$Result == "SOW" ~ "Shootout Win",
ovi_data_copy$Result == "SOL" ~ "Shootout Loss")
ovi_data_copy$HomeAway <- case_when(ovi_data_copy$HomeAway == "H" ~ "Home", ovi_data_copy$HomeAway == "A" ~ "Away")
ovi_data_copy$Strength <- case_when(ovi_data_copy$Strength == "EV" ~ "Even Strength", ovi_data_copy$Strength == "PP" ~ "Power Play", ovi_data_copy$Strength == "SH" ~ "Shorthanded")
ovi_data_copy$Time <- substr(ovi_data_copy$Time, start = 1, stop = 5)
ovi_data_copy$Team <- rep("Washington Capitals", nrow(ovi_data_copy))
ovi_data_copy <- merge(ovi_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
ovi_data_copy <- ovi_data_copy[c(2:ncol(ovi_data_copy))]
colnames(ovi_data_copy) <- c("Date", "Team", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
ovi_data_copy <- ovi_data_copy[, c(1, 2, 15, 3:14)]
ovi_data_copy <- left_join(ovi_data_copy, ovi_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
ovi_data_copy <- ovi_data_copy[, c(1:13, 18, 14:15)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_data_copy <- ovi_data_copy %>%
arrange(desc(Date, Period, Time))
ovi_data_copy$cgoal <- rev(c(1:776))
ovi_data_copy <- ovi_data_copy[, c(1:4, 17, 5:16)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
gretzky_data_copy <- gretzky_data
gretzky_data_copy[is.na(gretzky_data_copy)] <- "N/A"
gretzky_data_copy$PS <- case_when(gretzky_data_copy$PS == 0 ~ "No", gretzky_data_copy$PS == 1 ~ "Yes")
gretzky_data_copy$ENG <- case_when(gretzky_data_copy$ENG == 0 ~ "No", gretzky_data_copy$ENG == 1 ~ "Yes")
gretzky_data_copy$Result <- case_when(gretzky_data_copy$Result == "W" ~ "Regulation Win",
gretzky_data_copy$Result == "L" ~ "Regulation Loss",
gretzky_data_copy$Result == "OTW" ~ "Overtime Win",
gretzky_data_copy$Result == "OTL" ~ "Overtime Loss",
gretzky_data_copy$Result == "T" ~ "Tie")
gretzky_data_copy$HomeAway <- case_when(gretzky_data_copy$HomeAway == "H" ~ "Home", gretzky_data_copy$HomeAway == "A" ~ "Away")
gretzky_data_copy$Strength <- case_when(gretzky_data_copy$Strength == "EV" ~ "Even Strength", gretzky_data_copy$Strength == "PP" ~ "Power Play", gretzky_data_copy$Strength == "SH" ~ "Shorthanded")
gretzky_data_copy$Time <- substr(gretzky_data_copy$Time, start = 12, stop = 16)
gretzky_data_copy$Team <- case_when(gretzky_data_copy$Team == "EDM" ~ "Edmonton Oilers",
gretzky_data_copy$Team == "LAK" ~ "Los Angeles Kings",
gretzky_data_copy$Team == "STL" ~ "St. Louis Blues",
gretzky_data_copy$Team == "NYR" ~ "New York Rangers")
gretzky_data_copy <- merge(gretzky_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
gretzky_data_copy <- gretzky_data_copy[c(2:ncol(gretzky_data_copy))]
colnames(gretzky_data_copy) <- c("Date", "Team", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Result", "Home/Away", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
gretzky_data_copy <- gretzky_data_copy[, c(1, 2, 15, 3:10, 12, 11, 13, 14)]
gretzky_data_copy <- left_join(gretzky_data_copy, gretzky_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
gretzky_data_copy <- gretzky_data_copy[, c(1:13, 18, 14:15)]
colnames(gretzky_data_copy) <- c("Date", "Team", "Opponent", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
gretzky_data_copy <- gretzky_data_copy %>%
arrange(desc(Date, Period, Time))
gretzky_data_copy$cgoal <- rev(c(1:894))
gretzky_data_copy <- gretzky_data_copy[, c(1:4, 17, 5:16)]
colnames(gretzky_data_copy) <- c("Date", "Team", "Opponent", "Age", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
arrange(mtcars, desc(cyl), disp)
arrange(mtcars, desc(cyl), desc(disp))
ovi_data_copy <- ovi_data
ovi_data_copy[is.na(ovi_data_copy)] <- "N/A"
ovi_data_copy$PS <- case_when(ovi_data_copy$PS == 0 ~ "No", ovi_data_copy$PS == 1 ~ "Yes")
ovi_data_copy$ENG <- case_when(ovi_data_copy$ENG == 0 ~ "No", ovi_data_copy$ENG == 1 ~ "Yes")
ovi_data_copy$Result <- case_when(ovi_data_copy$Result == "W" ~ "Regulation Win",
ovi_data_copy$Result == "L" ~ "Regulation Loss",
ovi_data_copy$Result == "OTW" ~ "Overtime Win",
ovi_data_copy$Result == "OTL" ~ "Overtime Loss",
ovi_data_copy$Result == "SOW" ~ "Shootout Win",
ovi_data_copy$Result == "SOL" ~ "Shootout Loss")
ovi_data_copy$HomeAway <- case_when(ovi_data_copy$HomeAway == "H" ~ "Home", ovi_data_copy$HomeAway == "A" ~ "Away")
ovi_data_copy$Strength <- case_when(ovi_data_copy$Strength == "EV" ~ "Even Strength", ovi_data_copy$Strength == "PP" ~ "Power Play", ovi_data_copy$Strength == "SH" ~ "Shorthanded")
ovi_data_copy$Time <- substr(ovi_data_copy$Time, start = 1, stop = 5)
ovi_data_copy$Team <- rep("Washington Capitals", nrow(ovi_data_copy))
ovi_data_copy <- merge(ovi_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
ovi_data_copy <- ovi_data_copy[c(2:ncol(ovi_data_copy))]
colnames(ovi_data_copy) <- c("Date", "Team", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
ovi_data_copy <- ovi_data_copy[, c(1, 2, 15, 3:14)]
ovi_data_copy <- left_join(ovi_data_copy, ovi_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
ovi_data_copy <- ovi_data_copy[, c(1:13, 18, 14:15)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_data_copy <- ovi_data_copy %>%
arrange(desc(Date), desc(Period), desc(Time))
ovi_data_copy$cgoal <- rev(c(1:776))
ovi_data_copy <- ovi_data_copy[, c(1:4, 17, 5:16)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
gretzky_data_copy <- gretzky_data
gretzky_data_copy[is.na(gretzky_data_copy)] <- "N/A"
gretzky_data_copy$PS <- case_when(gretzky_data_copy$PS == 0 ~ "No", gretzky_data_copy$PS == 1 ~ "Yes")
gretzky_data_copy$ENG <- case_when(gretzky_data_copy$ENG == 0 ~ "No", gretzky_data_copy$ENG == 1 ~ "Yes")
gretzky_data_copy$Result <- case_when(gretzky_data_copy$Result == "W" ~ "Regulation Win",
gretzky_data_copy$Result == "L" ~ "Regulation Loss",
gretzky_data_copy$Result == "OTW" ~ "Overtime Win",
gretzky_data_copy$Result == "OTL" ~ "Overtime Loss",
gretzky_data_copy$Result == "T" ~ "Tie")
gretzky_data_copy$HomeAway <- case_when(gretzky_data_copy$HomeAway == "H" ~ "Home", gretzky_data_copy$HomeAway == "A" ~ "Away")
gretzky_data_copy$Strength <- case_when(gretzky_data_copy$Strength == "EV" ~ "Even Strength", gretzky_data_copy$Strength == "PP" ~ "Power Play", gretzky_data_copy$Strength == "SH" ~ "Shorthanded")
gretzky_data_copy$Time <- substr(gretzky_data_copy$Time, start = 12, stop = 16)
gretzky_data_copy$Team <- case_when(gretzky_data_copy$Team == "EDM" ~ "Edmonton Oilers",
gretzky_data_copy$Team == "LAK" ~ "Los Angeles Kings",
gretzky_data_copy$Team == "STL" ~ "St. Louis Blues",
gretzky_data_copy$Team == "NYR" ~ "New York Rangers")
gretzky_data_copy <- merge(gretzky_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
gretzky_data_copy <- gretzky_data_copy[c(2:ncol(gretzky_data_copy))]
colnames(gretzky_data_copy) <- c("Date", "Team", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Result", "Home/Away", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
gretzky_data_copy <- gretzky_data_copy[, c(1, 2, 15, 3:10, 12, 11, 13, 14)]
gretzky_data_copy <- left_join(gretzky_data_copy, gretzky_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
gretzky_data_copy <- gretzky_data_copy[, c(1:13, 18, 14:15)]
colnames(gretzky_data_copy) <- c("Date", "Team", "Opponent", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
gretzky_data_copy <- gretzky_data_copy %>%
arrange(desc(Date), desc(Period), desc(Time))
gretzky_data_copy$cgoal <- rev(c(1:894))
gretzky_data_copy <- gretzky_data_copy[, c(1:4, 17, 5:16)]
colnames(gretzky_data_copy) <- c("Date", "Team", "Opponent", "Age", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_data_copy <- ovi_data
ovi_data_copy[is.na(ovi_data_copy)] <- "N/A"
ovi_data_copy$PS <- case_when(ovi_data_copy$PS == 0 ~ "No", ovi_data_copy$PS == 1 ~ "Yes")
ovi_data_copy$ENG <- case_when(ovi_data_copy$ENG == 0 ~ "No", ovi_data_copy$ENG == 1 ~ "Yes")
ovi_data_copy$Result <- case_when(ovi_data_copy$Result == "W" ~ "Regulation Win",
ovi_data_copy$Result == "L" ~ "Regulation Loss",
ovi_data_copy$Result == "OTW" ~ "Overtime Win",
ovi_data_copy$Result == "OTL" ~ "Overtime Loss",
ovi_data_copy$Result == "SOW" ~ "Shootout Win",
ovi_data_copy$Result == "SOL" ~ "Shootout Loss")
ovi_data_copy$HomeAway <- case_when(ovi_data_copy$HomeAway == "H" ~ "Home", ovi_data_copy$HomeAway == "A" ~ "Away")
ovi_data_copy$Strength <- case_when(ovi_data_copy$Strength == "EV" ~ "Even Strength", ovi_data_copy$Strength == "PP" ~ "Power Play", ovi_data_copy$Strength == "SH" ~ "Shorthanded")
ovi_data_copy$Time <- substr(ovi_data_copy$Time, start = 1, stop = 5)
ovi_data_copy$Period <- replace(ovi_data_copy$Period, ovi_data_copy$Period == "OT", "Overtime")
ovi_data_copy$Team <- rep("Washington Capitals", nrow(ovi_data_copy))
ovi_data_copy <- merge(ovi_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
ovi_data_copy <- ovi_data_copy[c(2:ncol(ovi_data_copy))]
colnames(ovi_data_copy) <- c("Date", "Team", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
ovi_data_copy <- ovi_data_copy[, c(1, 2, 15, 3:14)]
ovi_data_copy <- left_join(ovi_data_copy, ovi_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
ovi_data_copy <- ovi_data_copy[, c(1:13, 18, 14:15)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_data_copy <- ovi_data_copy %>%
arrange(desc(Date), desc(Period), desc(Time))
ovi_data_copy$cgoal <- rev(c(1:776))
ovi_data_copy <- ovi_data_copy[, c(1:4, 17, 5:16)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
View(joint)
View(pivot_df)
library(data.table)
library(tidyverse)
library(dplyr)
library(plotly)
library(DT)
library(knitr)
library(RCurl)
# Initialize code chunk options
opts_chunk$set(
warning = FALSE,
message = FALSE,
eval=TRUE,
echo = TRUE,
cache = FALSE,
fig.width = 7,
fig.align = 'center',
fig.asp = 0.618,
out.width = "700px",
class.source = "code-r")
ovi_data <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/ovi-data.csv")
ovi_data <- read.csv(text = ovi_data)
gretzky_data <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/gretzky-data.csv")
gretzky_data <- read.csv(text = gretzky_data)
ovi_goals_by_date <- ovi_data %>%
group_by(Date) %>%
summarise(Goals = n())
unique_date_opponent_pairs <- ovi_data %>%
select(c("Date", "Opponent")) %>%
distinct(Date, Opponent)
ovi_goals_by_date <- merge(ovi_goals_by_date, unique_date_opponent_pairs)
caps_wins_by_date <- ovi_data %>%
distinct(Date, Result)
x_ovi <- merge(ovi_goals_by_date, caps_wins_by_date)
gretzky_goals_by_date <- gretzky_data %>%
group_by(Date) %>%
summarise(Goals = n())
wins_by_date <- gretzky_data %>%
distinct(Date, Result)
x_gretzky <- merge(gretzky_goals_by_date, wins_by_date)
ovi_potential_games <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/ovi-potential-games.csv")
ovi_potential_games <- read.csv(text = ovi_potential_games)
gretzky_potential_games <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/gretzky-potential-games.csv")
gretzky_potential_games <- read.csv(text = gretzky_potential_games)
name_table <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/name-table.csv")
name_table <- read.csv(text = name_table)
gretzky_age_stats <- gretzky_data %>%
group_by(Age) %>%
summarise(Goals = n())
ovi_age_stats <- ovi_data %>%
group_by(Age) %>%
summarise(Goals = n())
ovi_age_goals <- ovi_age_stats %>%
ggplot(aes(x = Age, Goals)) +
geom_bar(stat = "identity", fill = "red") +
ylab("Goals") +
ggtitle("Number of goals scored by Ovechkin at varying ages in his NHL career") +
theme_minimal()
gretzky_age_goals <- gretzky_age_stats %>%
ggplot(aes(x = Age, Goals)) +
geom_bar(stat = "identity", fill = "blue") +
ylab("Goals") +
ggtitle("Number of goals scored by Gretzky at varying ages in his NHL career") +
theme_minimal()
joint <- left_join(gretzky_age_stats, ovi_age_stats, by = "Age") %>%
rename(Gretzky = Goals.x, Ovechkin = Goals.y)
joint[is.na(joint)] <- 0
ovi_gretzky_joint <- joint %>%
gather(Player, Goals, -Age) %>%
ggplot(aes(x = Age, y = Goals, fill = Player)) +
scale_fill_manual(values = c("blue", "red")) +
geom_col(position = "dodge") +
ylab("Goals") +
ggtitle("Comparison of the number of goals scored by both \n Ovechkin and Gretzky at varying ages in their NHL careers") +
theme_minimal()
ggplotly(ovi_age_goals) %>%
layout(hoverlabel=list(bgcolor="white"))
ggplotly(gretzky_age_goals) %>%
layout(hoverlabel=list(bgcolor="white"))
ggplotly(ovi_gretzky_joint)%>%
layout(hoverlabel=list(bgcolor="white"))
# datatable2 - datatable with child rows
datatable2 <- function(x, vars = NULL, opts = NULL, ...) {
names_x <- names(x)
if (is.null(vars)) stop("'vars' must be specified!")
pos <- match(vars, names_x)
if (any(map_chr(x[, pos], typeof) == "list"))
stop("list columns are not supported in datatable2()")
pos <- pos[pos <= ncol(x)] + 1
rownames(x) <- NULL
if (nrow(x) > 0) x <- cbind(' ' = '&oplus;', x)
# options
opts <- c(
opts,
list(
columnDefs = list(
list(visible = FALSE, targets = c(0, pos)),
list(orderable = FALSE, className = 'details-control', targets = 1),
list(className = 'dt-left', targets = 1:3),
list(className = 'dt-right', targets = 4:ncol(x))
)
))
datatable(
x,
...,
escape = -2,
options = opts,
callback = JS(.callback2(x = x, pos = c(0, pos)))
)
}
.callback2 <- function(x, pos = NULL) {
part1 <- "table.column(1).nodes().to$().css({cursor: 'pointer'});"
part2 <- .child_row_table2(x, pos = pos)
part3 <-
"
table.on('click', 'td.details-control', function() {
var td = $(this), row = table.row(td.closest('tr'));
if (row.child.isShown()) {
row.child.hide();
td.html('&oplus;');
} else {
row.child(format(row.data())).show();
td.html('&ominus;');
}
});"
paste(part1, part2, part3)
}
.child_row_table2 <- function(x, pos = NULL) {
names_x <- paste0(names(x), ":")
text <- "
var format = function(d) {
text = '<div><table >' +
"
for (i in seq_along(pos)) {
text <- paste(text, glue::glue(
"'<tr>' +
'<td>' + '{names_x[pos[i]]}' + '</td>' +
'<td>' + d[{pos[i]}] + '</td>' +
'</tr>' + " ))
}
paste0(text,
"'</table></div>'
return text;};"
)
}
ovi_data_copy <- ovi_data
ovi_data_copy[is.na(ovi_data_copy)] <- "N/A"
ovi_data_copy$PS <- case_when(ovi_data_copy$PS == 0 ~ "No", ovi_data_copy$PS == 1 ~ "Yes")
ovi_data_copy$ENG <- case_when(ovi_data_copy$ENG == 0 ~ "No", ovi_data_copy$ENG == 1 ~ "Yes")
ovi_data_copy$Result <- case_when(ovi_data_copy$Result == "W" ~ "Regulation Win",
ovi_data_copy$Result == "L" ~ "Regulation Loss",
ovi_data_copy$Result == "OTW" ~ "Overtime Win",
ovi_data_copy$Result == "OTL" ~ "Overtime Loss",
ovi_data_copy$Result == "SOW" ~ "Shootout Win",
ovi_data_copy$Result == "SOL" ~ "Shootout Loss")
ovi_data_copy$HomeAway <- case_when(ovi_data_copy$HomeAway == "H" ~ "Home", ovi_data_copy$HomeAway == "A" ~ "Away")
ovi_data_copy$Strength <- case_when(ovi_data_copy$Strength == "EV" ~ "Even Strength", ovi_data_copy$Strength == "PP" ~ "Power Play", ovi_data_copy$Strength == "SH" ~ "Shorthanded")
ovi_data_copy$Time <- substr(ovi_data_copy$Time, start = 1, stop = 5)
ovi_data_copy$Period <- case_when(ovi_data_copy$Period == 1 ~ "1st", ovi_data_copy$Period == 2 ~ "2nd", ovi_data_copy$Period == 3 ~ "3rd", ovi_data_copy$Period == "OT" ~ "Overtime")
ovi_data_copy$Team <- rep("Washington Capitals", nrow(ovi_data_copy))
ovi_data_copy <- merge(ovi_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
ovi_data_copy <- ovi_data_copy[c(2:ncol(ovi_data_copy))]
colnames(ovi_data_copy) <- c("Date", "Team", "Age (years)", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
ovi_data_copy <- ovi_data_copy[, c(1, 2, 15, 3:14)]
ovi_data_copy <- left_join(ovi_data_copy, ovi_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
ovi_data_copy <- ovi_data_copy[, c(1:13, 18, 14:15)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age (years)", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_data_copy <- ovi_data_copy %>%
arrange(desc(Date), desc(Period), desc(Time))
ovi_data_copy$cgoal <- rev(c(1:776))
ovi_data_copy <- ovi_data_copy[, c(1:4, 17, 5:16)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age (years)", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
gretzky_data_copy <- gretzky_data
gretzky_data_copy[is.na(gretzky_data_copy)] <- "N/A"
gretzky_data_copy$PS <- case_when(gretzky_data_copy$PS == 0 ~ "No", gretzky_data_copy$PS == 1 ~ "Yes")
gretzky_data_copy$ENG <- case_when(gretzky_data_copy$ENG == 0 ~ "No", gretzky_data_copy$ENG == 1 ~ "Yes")
gretzky_data_copy$Result <- case_when(gretzky_data_copy$Result == "W" ~ "Regulation Win",
gretzky_data_copy$Result == "L" ~ "Regulation Loss",
gretzky_data_copy$Result == "OTW" ~ "Overtime Win",
gretzky_data_copy$Result == "OTL" ~ "Overtime Loss",
gretzky_data_copy$Result == "T" ~ "Tie")
gretzky_data_copy$HomeAway <- case_when(gretzky_data_copy$HomeAway == "H" ~ "Home", gretzky_data_copy$HomeAway == "A" ~ "Away")
gretzky_data_copy$Strength <- case_when(gretzky_data_copy$Strength == "EV" ~ "Even Strength", gretzky_data_copy$Strength == "PP" ~ "Power Play", gretzky_data_copy$Strength == "SH" ~ "Shorthanded")
gretzky_data_copy$Time <- substr(gretzky_data_copy$Time, start = 12, stop = 16)
gretzky_data_copy$Period <- case_when(gretzky_data_copy$Period == 1 ~ "1st", gretzky_data_copy$Period == 2 ~ "2nd", gretzky_data_copy$Period == 3 ~ "3rd", gretzky_data_copy$Period == "OT" ~ "Overtime")
gretzky_data_copy$Team <- case_when(gretzky_data_copy$Team == "EDM" ~ "Edmonton Oilers",
gretzky_data_copy$Team == "LAK" ~ "Los Angeles Kings",
gretzky_data_copy$Team == "STL" ~ "St. Louis Blues",
gretzky_data_copy$Team == "NYR" ~ "New York Rangers")
gretzky_data_copy <- merge(gretzky_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
gretzky_data_copy <- gretzky_data_copy[c(2:ncol(gretzky_data_copy))]
colnames(gretzky_data_copy) <- c("Date", "Team", "Age (years)", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Result", "Home/Away", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
gretzky_data_copy <- gretzky_data_copy[, c(1, 2, 15, 3:10, 12, 11, 13, 14)]
gretzky_data_copy <- left_join(gretzky_data_copy, gretzky_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
gretzky_data_copy <- gretzky_data_copy[, c(1:13, 18, 14:15)]
colnames(gretzky_data_copy) <- c("Date", "Team", "Opponent", "Age (years)", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
gretzky_data_copy <- gretzky_data_copy %>%
arrange(desc(Date), desc(Period), desc(Time))
gretzky_data_copy$cgoal <- rev(c(1:894))
gretzky_data_copy <- gretzky_data_copy[, c(1:4, 17, 5:16)]
colnames(gretzky_data_copy) <- c("Date", "Team", "Opponent", "Age (years)", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
datatable2(x = ovi_data_copy, vars = colnames(ovi_data_copy)[-c(1, 2, 3, 5)])
datatable2(x = gretzky_data_copy, vars = colnames(gretzky_data_copy)[-c(1, 2, 3, 5)])
ovi_goalies <- ovi_data %>%
filter(!is.na(Goalie)) %>%
group_by(Goalie) %>%
summarise(Goals = n())
gretzky_goalies <- gretzky_data %>%
filter(!is.na(Goalie)) %>%
group_by(Goalie) %>%
summarise(Goals = n())
ovi_goalies_plot <- ovi_goalies %>%
ggplot(aes(x = reorder(Goalie, Goals), y = Goals, text = paste("Goalie: ", Goalie, '\nGoals: ', Goals))) +
geom_bar(stat = "identity", fill = "red") +
ylab("Goals") +
xlab("Goalie") +
ggtitle("Number of goals scored on various goalies by Ovechkin \n throughout in his NHL career") +
theme_minimal() +
coord_flip()
gretzky_goalies_plot <- gretzky_goalies %>%
ggplot(aes(x = reorder(Goalie, Goals), y = Goals, text = paste("Goalie: ", Goalie, '\nGoals: ', Goals))) +
geom_bar(stat = "identity", fill = "blue") +
ylab("Goals") +
xlab("Goalie") +
ggtitle("Number of goals scored on various goalies by Gretzky \n throughout in his NHL career") +
theme_minimal() +
coord_flip()
ggplotly(ovi_goalies_plot, tooltip = c("text")) %>%
layout(autosize = F, height = 2000, hoverlabel=list(bgcolor="white"))
ggplotly(gretzky_goalies_plot, tooltip = c("text")) %>%
layout(autosize = F, height = 2000, hoverlabel=list(bgcolor="white"))
