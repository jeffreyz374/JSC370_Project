library(patchwork)
ovi_data <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/ovi-data.csv")
ovi_data <- read.csv(text = ovi_data)
gretzky_data <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/gretzky-data.csv")
gretzky_data <- read.csv(text = gretzky_data)
ovi_goals_by_date <- ovi_data %>%
group_by(Date) %>%
summarise(Goals = n())
caps_wins_by_date <- ovi_data %>%
distinct(Date, Result)
ovi_model_set <- merge(ovi_goals_by_date, caps_wins_by_date)
gretzky_goals_by_date <- gretzky_data %>%
group_by(Date) %>%
summarise(Goals = n())
wins_by_date <- gretzky_data %>%
distinct(Date, Result)
gretzky_model_set <- merge(gretzky_goals_by_date, wins_by_date)
ovi_potential_games <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/ovi-potential-games.csv")
ovi_potential_games <- read.csv(text = ovi_potential_games)
gretzky_potential_games <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/gretzky-potential-games.csv")
gretzky_potential_games <- read.csv(text = gretzky_potential_games)
name_table <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/name-table.csv")
name_table <- read.csv(text = name_table)
for (i in 1:3) {
temp <- ovi_data %>%
filter(Period == i) %>%
group_by(Date) %>%
summarise(goals = n())
to_add <- setdiff(ovi_model_set$Date, temp$Date)
missing <- data.frame(Date = to_add, goals = rep(0, length(to_add)))
temp <- rbind(temp, missing)
if (i == 1) {
temp <- temp %>%
rename(p1_goals = goals)
} else if (i == 2) {
temp <- temp %>%
rename(p2_goals = goals)
} else {
temp <- temp %>%
rename(p3_goals = goals)
}
ovi_model_set <- merge(ovi_model_set, temp)
temp <- gretzky_data %>%
filter(Period == i) %>%
group_by(Date) %>%
summarise(goals = n())
to_add <- setdiff(gretzky_model_set$Date, temp$Date)
missing <- data.frame(Date = to_add, goals = rep(0, length(to_add)))
temp <- rbind(temp, missing)
if (i == 1) {
temp <- temp %>%
rename(p1_goals = goals)
} else if (i == 2) {
temp <- temp %>%
rename(p2_goals = goals)
} else {
temp <- temp %>%
rename(p3_goals = goals)
}
gretzky_model_set <- merge(gretzky_model_set, temp)
}
temp <- ovi_data %>%
filter(Period == "OT") %>%
group_by(Date) %>%
summarise(ot_goals = n())
to_add <- setdiff(ovi_model_set$Date, temp$Date)
missing <- data.frame(Date = to_add, ot_goals = rep(0, length(to_add)))
temp <- rbind(temp, missing)
ovi_model_set <- merge(ovi_model_set, temp)
temp <- gretzky_data %>%
filter(Period == "OT") %>%
group_by(Date) %>%
summarise(ot_goals = n())
to_add <- setdiff(gretzky_model_set$Date, temp$Date)
missing <- data.frame(Date = to_add, ot_goals = rep(0, length(to_add)))
temp <- rbind(temp, missing)
gretzky_model_set <- merge(gretzky_model_set, temp)
temp <- ovi_data %>%
group_by(Date) %>%
summarise(engs = sum(ENG), pss = sum(PS))
ovi_model_set <- merge(ovi_model_set, temp)
temp <- gretzky_data %>%
group_by(Date) %>%
summarise(engs = sum(ENG), pss = sum(PS))
gretzky_model_set <- merge(gretzky_model_set, temp)
vec <- c("EV", "PP", "SH")
for (i in 1:3) {
temp <- ovi_data %>%
filter(Strength == vec[i]) %>%
group_by(Date) %>%
summarise(goals = n())
to_add <- setdiff(ovi_model_set$Date, temp$Date)
missing <- data.frame(Date = to_add, goals = rep(0, length(to_add)))
temp <- rbind(temp, missing)
if (i == 1) {
temp <- temp %>%
rename(ev_goals = goals)
} else if (i == 2) {
temp <- temp %>%
rename(pp_goals = goals)
} else {
temp <- temp %>%
rename(sh_goals = goals)
}
ovi_model_set <- merge(ovi_model_set, temp)
temp <- gretzky_data %>%
filter(Strength == vec[i]) %>%
group_by(Date) %>%
summarise(goals = n())
to_add <- setdiff(gretzky_model_set$Date, temp$Date)
missing <- data.frame(Date = to_add, goals = rep(0, length(to_add)))
temp <- rbind(temp, missing)
if (i == 1) {
temp <- temp %>%
rename(ev_goals = goals)
} else if (i == 2) {
temp <- temp %>%
rename(pp_goals = goals)
} else {
temp <- temp %>%
rename(sh_goals = goals)
}
gretzky_model_set <- merge(gretzky_model_set, temp)
}
to_add <- setdiff(ovi_potential_games$Date, ovi_model_set$Date)
missing <- ovi_potential_games %>%
filter(Date %in% to_add) %>%
dplyr::select(c("Date", "Result")) %>%
mutate(Goals = rep(0, nrow(ovi_potential_games) - nrow(ovi_model_set)),
p1_goals = rep(0, nrow(ovi_potential_games) - nrow(ovi_model_set)),
p2_goals = rep(0, nrow(ovi_potential_games) - nrow(ovi_model_set)),
p3_goals = rep(0, nrow(ovi_potential_games) - nrow(ovi_model_set)),
ot_goals = rep(0, nrow(ovi_potential_games) - nrow(ovi_model_set)),
engs = rep(0, nrow(ovi_potential_games) - nrow(ovi_model_set)),
pss = rep(0, nrow(ovi_potential_games) - nrow(ovi_model_set)),
ev_goals = rep(0, nrow(ovi_potential_games) - nrow(ovi_model_set)),
pp_goals = rep(0, nrow(ovi_potential_games) - nrow(ovi_model_set)),
sh_goals = rep(0, nrow(ovi_potential_games) - nrow(ovi_model_set)))
missing <- missing[, c(1, 3, 2, 4:12)]
ovi_model_set <- rbind(ovi_model_set, missing) %>%
arrange(desc(Date))
to_add <- setdiff(gretzky_potential_games$Date, gretzky_model_set$Date)
missing <- gretzky_potential_games %>%
filter(Date %in% to_add) %>%
dplyr::select(c("Date", "Result")) %>%
mutate(Goals = rep(0, nrow(gretzky_potential_games) - nrow(gretzky_model_set)),
p1_goals = rep(0, nrow(gretzky_potential_games) - nrow(gretzky_model_set)),
p2_goals = rep(0, nrow(gretzky_potential_games) - nrow(gretzky_model_set)),
p3_goals = rep(0, nrow(gretzky_potential_games) - nrow(gretzky_model_set)),
ot_goals = rep(0, nrow(gretzky_potential_games) - nrow(gretzky_model_set)),
engs = rep(0, nrow(gretzky_potential_games) - nrow(gretzky_model_set)),
pss = rep(0, nrow(gretzky_potential_games) - nrow(gretzky_model_set)),
ev_goals = rep(0, nrow(gretzky_potential_games) - nrow(gretzky_model_set)),
pp_goals = rep(0, nrow(gretzky_potential_games) - nrow(gretzky_model_set)),
sh_goals = rep(0, nrow(gretzky_potential_games) - nrow(gretzky_model_set)))
missing <- missing[, c(1, 3, 2, 4:12)]
gretzky_model_set <- rbind(gretzky_model_set, missing) %>%
arrange(desc(Date))
vec <- rep(0, nrow(ovi_model_set))
ovi_ages <- as.Date(ovi_model_set$Date)
for (i in 1:nrow(ovi_model_set)) {
if (month(ovi_ages[i]) == 9 & mday(ovi_ages[i]) == 17) {
vec[i] = year(ovi_ages[i]) - 1961
} else {
vec[i] = as.numeric(floor((ovi_ages[i] - as.Date("1985-09-17")) / 365.25))
}
}
ovi_model_set <- ovi_model_set %>%
mutate(Age = vec)
vec <- rep(0, nrow(gretzky_model_set))
gretzky_ages <- as.Date(gretzky_model_set$Date)
for (i in 1:nrow(gretzky_model_set)) {
if (month(gretzky_ages[i]) == 1 & mday(gretzky_ages[i]) == 26) {
vec[i] = year(gretzky_ages[i]) - 1961
} else {
vec[i] = as.numeric(floor((gretzky_ages[i] - as.Date("1961-01-26")) / 365.25))
}
}
gretzky_model_set <- gretzky_model_set %>%
mutate(Age = vec)
ovi_model_set <- merge(ovi_model_set, ovi_potential_games %>% dplyr::select(c("Date", "HomeAway")))
ovi_model_set <- ovi_model_set %>%
mutate(multi_goals = ifelse(Goals > 1, 1, 0)) %>%
arrange(desc(Date))
gretzky_model_set <- merge(gretzky_model_set, gretzky_potential_games %>% dplyr::select(c("Date", "HomeAway")))
gretzky_model_set <- gretzky_model_set %>%
mutate(multi_goals = ifelse(Goals > 1, 1, 0)) %>%
arrange(desc(Date))
ovi_model_set <- ovi_model_set[, c(1, 13, 14, 15, 2, 4:12, 3)]
gretzky_model_set <- gretzky_model_set[, c(1, 13, 14, 15, 2, 4:12, 3)]
ovi_model_set$Result <- factor(ovi_model_set$Result, levels = c("W", "OTW", "SOW", "SOL", "OTL", "L"))
gretzky_model_set$Result <- factor(gretzky_model_set$Result, levels = c("W", "OTW", "T", "OTL", "L"))
ovi_model_set$HomeAway <- factor(ovi_model_set$HomeAway, levels = c("H", "A"))
gretzky_model_set$HomeAway <- factor(gretzky_model_set$HomeAway, levels = c("H", "A"))
# goal_775 <- data.frame(Date = c("2022-04-10"), Team = c("WSH"), Opponent = c("BOS"), Age = c(36), Assist1 = c("Evgeny Kuznetsov"), Assist2 = c("John Carlson"), Goalie = c(NA), Period = c(3), Time = c("19:58:00"), Strength = c("EV"), ArenaName = c("Capital One Arena"), HomeAway = c("H"), Result = c("W"), ENG = c(1), PS = c(0))
caps_wins_by_date %>%
ggplot(aes(x = Result)) +
geom_bar() +
ggtitle("Frequencies of different game outcomes for Ovechkin's team
when Ovechkin scores at least one goal") +
theme_minimal()
wins_by_date %>%
ggplot(aes(x = Result)) +
geom_bar() +
ggtitle("Frequencies of different game outcomes for Gretzky's team
when Gretzky scores at least one goal") +
theme_minimal()
ovi_model_set %>%
filter(Goals == 0) %>%
ggplot(aes(x = Result)) +
geom_bar() +
ggtitle("Frequencies of different game outcomes for Ovechkin's team
when Ovechkin DOES NOT score a goal") +
theme_minimal()
gretzky_model_set %>%
filter(Goals == 0) %>%
ggplot(aes(x = Result)) +
geom_bar() +
ggtitle("Frequencies of different game outcomes for Gretzky's team
when Gretzky DOES NOT score a goal") +
theme_minimal()
ovi_ev_estimates <- c("1.4052", "1.1412", "0.5371", "0.6198", "0.5108", "0.9677", "0.8171")
ovi_ev_cis <- c("(1.1461, 1.7237)", "(0.6840, 1.8978)", "(0.3776, 0.7604)", "(0.4441, 0.8631)", "(0.3595, 0.7231)", "(0.5013, 1.8782)", "(0.6142, 1.0869)")
ovi_ev_rownames <- c("Away Game",
"Multi-Goal Game",
"First Period Goal Count",
"Second Period Goal Count",
"Third Period Goal Count",
"Overtime Period Goal Count",
"Even Strength Goal Count")
ovi_ev_colnames <- c("Coefficient Estimates", "Corresponding 95% Confidence Intervals")
ovi_ev_table <- cbind(ovi_ev_estimates, ovi_ev_cis)
rownames(ovi_ev_table) <- ovi_ev_rownames
colnames(ovi_ev_table) <- ovi_ev_colnames
ovi_ev_table %>%
knitr::kable(align = c("r", "r"))
ovi_pp_estimates <- c("1.4041", "1.1424", "0.4451", "0.5136", "0.4219", "0.7948", "1.1852")
ovi_pp_cis <- c("(1.1454, 1.7225)", "(0.6848, 1.8996)", "(0.3181, 0.6192)", "(0.3740, 0.7028)", "(0.3130, 0.5655)", "(0.4294, 1.4749)", "(0.8896, 1.5788)")
ovi_pp_rownames <- c("Away Game",
"Multi-Goal Game",
"First Period Goal Count",
"Second Period Goal Count",
"Third Period Goal Count",
"Overtime Period Goal Count",
"Power Play Goal Count")
ovi_pp_colnames <- c("Coefficient Estimates", "Corresponding 95% Confidence Intervals")
ovi_pp_table <- cbind(ovi_pp_estimates, ovi_pp_cis)
rownames(ovi_pp_table) <- ovi_pp_rownames
colnames(ovi_pp_table) <- ovi_pp_colnames
ovi_pp_table %>%
knitr::kable(align = c("r", "r"))
ovi_sh_estimates <- c("1.4058", "1.1426", "0.4753", "0.5522", "0.4355", "0.8205", "4.2644")
ovi_sh_cis <- c("(1.1467, 1.7245)", "(0.6849, 1.8999)", "(0.3477, 0.6460)", "(0.4126, 0.7371)", "(0.3267, 0.5777)", "(0.4446, 1.5197)", "(0.6633, 33.8469)")
ovi_sh_rownames <- c("Away Game",
"Multi-Goal Game",
"First Period Goal Count",
"Second Period Goal Count",
"Third Period Goal Count",
"Overtime Period Goal Count",
"Power Play Goal Count")
ovi_sh_colnames <- c("Coefficient Estimates", "Corresponding 95% Confidence Intervals")
ovi_sh_table <- cbind(ovi_sh_estimates, ovi_sh_cis)
rownames(ovi_sh_table) <- ovi_sh_rownames
colnames(ovi_sh_table) <- ovi_sh_colnames
ovi_sh_table %>%
knitr::kable(align = c("r", "r"))
g2_ev <- polr(Result ~ HomeAway + multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + ev_goals, data = gretzky_model_set, Hess = TRUE)
gretzky_ev_estimates <- format(round(exp(summary(g2_ev)$coeff)[,1], 4), nsmall = 2)
gretzky_ev_cis <- format(round(exp(confint(g2_ev)),2)[-1,], nsmall = 2)
gretzky_ev_cis <- str_c("(", trimws(gretzky_ev_cis[,1]), ", ", gretzky_ev_cis[,2], ")")
gretzky_ev_table <- cbind(gretzky_ev_estimates, gretzky_ev_cis)
gretzky_ev_rownames <- c("Away Game", "Multi-Goal Game", "First Period Goal Count", "Second Period Goal Count", "Third Period Goal Count", "Overtime Period Goal Count", "Even Strength Goal Count")
gretzky_ev_colnames <- c("Coefficient Estimates", "Corresponding 95% Confidence Intervals")
rownames(gretzky_ev_table) <- gretzky_ev_rownames
gretzky_ev_estimates
gretzky_ev_cis
summary(g2_ev)
summary(g2_ev)$coef
summary(g2_ev)$coef[1]
summary(g2_ev)$coef[2]
summary(g2_ev)$coef[:]
summary(g2_ev)$coef[1:7]
exp(summary(g2_ev)$coef[1:7])
toString(exp(summary(g2_ev)$coef[1:7]))
toString(round(exp(summary(g2_ev)$coef[1:7]), 4))
confint(g2_ev)
str_c("(", trimws(format(round(exp(confint(g2_ev)), 4)[-1,], nsmall = 2)[,1]), ", ", format(round(exp(confint(g2_ev)), 4)[,2], ")")
)
str_c("(", trimws(format(round(exp(confint(g2_ev)),2)[-1,], nsmall = 2)[,1]), ", ", format(round(exp(confint(g2_ev)),2)[-1,], nsmall = 2)[,2], ")")
exp(condint(g2_ev))
exp(confint(g2_ev))
gretzky_ev_estimates <- c("1.9135", "0.8012", "0.5712", "0.632", "0.3082", "1.4206", "0.8378")
gretzky_ev_cis <- c("(1.5765, 2.3245)", "(0.4584, 1.3836)", "(0.3846, 0.8443)", "(0.4525, 0.8811)", "(0.2099, 0.4486)", "(0.1574, 12.9742)", "(0.6166, 1.1405)")
gretzky_ev_rownames <- c("Away Game", "Multi-Goal Game", "First Period Goal Count", "Second Period Goal Count", "Third Period Goal Count", "Overtime Period Goal Count", "Even Strength Goal Count")
gretzky_ev_colnames <- c("Coefficient Estimates", "Corresponding 95% Confidence Intervals")
gretzky_ev_table <- cbind(gretzky_ev_estimates, gretzky_ev_cis)
rownames(gretzky_ev_table) <- gretzky_ev_rownames
colnames(gretzky_ev_table) <- gretzky_ev_colnames
gretzky_ev_table %>%
knitr::kable(align = c("r", "r"))
toString(round(exp(summary(g2_ev)$coef[1:7]), 4))
g2_pp <- polr(Result ~ HomeAway + multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + pp_goals, data = gretzky_model_set, Hess = TRUE)
exp(coef(g2_pp))
toString(round(exp(summary(g2_pp)$coef[1:7]), 4))
round(exp(confint(g2_pp)), 4)
gretzky_pp_estimates <- c("1.9097", "0.7944", "0.4509", "0.4920", "0.2459", "1.2247", "1.6058")
gretzky_pp_cis <- c("(1.5730, 2.3205)", "(0.4534, 1.3752)", "(0.3229, 0.6252)", "(0.3647, 0.6612)", "(0.1796, 0.3336)", "(0.1384, 10.9465)", "(1.1643, 2.2129)")
gretzky_pp_rownames <- c("Away Game", "Multi-Goal Game", "First Period Goal Count", "Second Period Goal Count", "Third Period Goal Count", "Overtime Period Goal Count", "Power Play Goal Count")
gretzky_pp_colnames <- c("Coefficient Estimates", "Corresponding 95% Confidence Intervals")
gretzky_pp_table <- cbind(gretzky_pp_estimates, gretzky_pp_cis)
rownames(gretzky_pp_table) <- gretzky_pp_rownames
colnames(gretzky_pp_table) <- gretzky_pp_colnames
gretzky_pp_table %>%
knitr::kable(align = c("r", "r"))
g2_sh <- polr(Result ~ HomeAway + multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + sh_goals, data = gretzky_model_set, Hess = TRUE)
toString(round(exp(summary(g2_sh)$coef[1:7]), 4))
round(exp(confint(g2_sh)), 4)
gretzky_sh_estimates <- c("1.9106", "0.8459", "0.5163", "0.6192", "0.2802", "1.1100", "0.3947")
gretzky_sh_cis <- c("(1.5736, 2.3217)", "(0.4834, 1.4631)", "(0.3729, 0.7108)", "(0.4658, 0.8216)", "(0.2061 0.3777)", "(0.1275, 9.7393)", "(0.1949, 0.7379)")
gretzky_sh_rownames <- c("Away Game", "Multi-Goal Game", "First Period Goal Count", "Second Period Goal Count", "Third Period Goal Count", "Overtime Period Goal Count", "Shorthanded Goal Count")
gretzky_sh_colnames <- c("Coefficient Estimates", "Corresponding 95% Confidence Intervals")
gretzky_sh_table <- cbind(gretzky_sh_estimates, gretzky_sh_cis)
rownames(gretzky_sh_table) <- gretzky_sh_rownames
colnames(gretzky_sh_table) <- gretzky_sh_colnames
gretzky_sh_table %>%
knitr::kable(align = c("r", "r"))
?knitr::kable
View(ovi_data)
library(data.table)
library(tidyverse)
library(dplyr)
library(plotly)
library(DT)
library(knitr)
library(RCurl)
# Initialize code chunk options
opts_chunk$set(
warning = FALSE,
message = FALSE,
eval=TRUE,
echo = TRUE,
cache = FALSE,
fig.width = 7,
fig.align = 'center',
fig.asp = 0.618,
out.width = "700px",
class.source = "code-r")
ovi_data <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/ovi-data.csv")
ovi_data <- read.csv(text = ovi_data)
gretzky_data <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/gretzky-data.csv")
gretzky_data <- read.csv(text = gretzky_data)
ovi_goals_by_date <- ovi_data %>%
group_by(Date) %>%
summarise(Goals = n())
unique_date_opponent_pairs <- ovi_data %>%
select(c("Date", "Opponent")) %>%
distinct(Date, Opponent)
ovi_goals_by_date <- merge(ovi_goals_by_date, unique_date_opponent_pairs)
caps_wins_by_date <- ovi_data %>%
distinct(Date, Result)
x_ovi <- merge(ovi_goals_by_date, caps_wins_by_date)
gretzky_goals_by_date <- gretzky_data %>%
group_by(Date) %>%
summarise(Goals = n())
wins_by_date <- gretzky_data %>%
distinct(Date, Result)
x_gretzky <- merge(gretzky_goals_by_date, wins_by_date)
ovi_potential_games <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/ovi-potential-games.csv")
ovi_potential_games <- read.csv(text = ovi_potential_games)
gretzky_potential_games <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/gretzky-potential-games.csv")
gretzky_potential_games <- read.csv(text = gretzky_potential_games)
name_table <- getURL("https://raw.githubusercontent.com/jeffreyz374/JSC370_Project/main/Data/name-table.csv")
name_table <- read.csv(text = name_table)
View(x_ovi)
ovi_data_copy <- ovi_data
ovi_data_copy[is.na(ovi_data_copy)] <- "N/A"
ovi_data_copy$PS <- case_when(ovi_data_copy$PS == 0 ~ "No", ovi_data_copy$PS == 1 ~ "Yes")
ovi_data_copy$ENG <- case_when(ovi_data_copy$ENG == 0 ~ "No", ovi_data_copy$ENG == 1 ~ "Yes")
ovi_data_copy$Result <- case_when(ovi_data_copy$Result == "W" ~ "Regulation Win",
ovi_data_copy$Result == "L" ~ "Regulation Loss",
ovi_data_copy$Result == "OTW" ~ "Overtime Win",
ovi_data_copy$Result == "OTL" ~ "Overtime Loss",
ovi_data_copy$Result == "SOW" ~ "Shootout Win",
ovi_data_copy$Result == "SOL" ~ "Shootout Loss")
ovi_data_copy$HomeAway <- case_when(ovi_data_copy$HomeAway == "H" ~ "Home", ovi_data_copy$HomeAway == "A" ~ "Away")
ovi_data_copy$Strength <- case_when(ovi_data_copy$Strength == "EV" ~ "Even Strength", ovi_data_copy$Strength == "PP" ~ "Power Play", ovi_data_copy$Strength == "SH" ~ "Shorthanded")
ovi_data_copy$Time <- substr(ovi_data_copy$Time, start = 1, stop = 5)
ovi_data_copy$Period <- case_when(ovi_data_copy$Period == 1 ~ "1st", ovi_data_copy$Period == 2 ~ "2nd", ovi_data_copy$Period == 3 ~ "3rd", ovi_data_copy$Period == "OT" ~ "Overtime")
ovi_data_copy$Team <- rep("Washington Capitals", nrow(ovi_data_copy))
ovi_data_copy <- merge(ovi_data_copy, name_table, by.x = c("Opponent"), by.y = c("Abbreviation"))
ovi_data_copy <- ovi_data_copy[c(2:ncol(ovi_data_copy))]
colnames(ovi_data_copy) <- c("Date", "Team", "Age (years)", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Empty Net Goal", "Penalty Shot Goal", "Opponent")
ovi_data_copy <- ovi_data_copy[, c(1, 2, 15, 3:14)]
ovi_data_copy <- left_join(ovi_data_copy, ovi_potential_games[c(1, 3, 4)], by = "Date") %>%
mutate(Final = paste(GF, "-", GA))
ovi_data_copy <- ovi_data_copy[, c(1:13, 18, 14:15)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age (years)", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
ovi_data_copy <- ovi_data_copy %>%
arrange(desc(Date), desc(Period), desc(Time))
ovi_data_copy$cgoal <- rev(c(1:776))
ovi_data_copy <- ovi_data_copy[, c(1:4, 17, 5:16)]
colnames(ovi_data_copy) <- c("Date", "Team", "Opponent", "Age (years)", "Career Goal Number", "1st Assist", "2nd Assist", "Goalie", "Period", "Time", "Strength", "Arena", "Home/Away", "Result", "Final Score", "Empty Net Goal", "Penalty Shot Goal")
View(ovi_data_copy)
View(ovi_data_copy)
ovi_goalies
?replace
ovi_data$Goalie
replace(ovi_data$Goalie, is.na(ovi_data$Goalie), "Empty Net")
ovi_data %>%
filter(is.na(Goalie))
View(x_gretzky)
merge(ovi_potential_games, setdiff(ovi_potential_games, x_ovi))
inner_join(ovi_potential_games, setdiff(ovi_potential_games, x_ovi))
inner_join(ovi_potential_games, setdiff(ovi_potential_games$Date, x_ovi$Date))
setdiff(ovi_potential_games$Date, x_ovi$Date)
merge(ovi_potential_games, setdiff(ovi_potential_games$Date, x_ovi$Date), by = "Date")
merge(ovi_potential_games, setdiff(ovi_potential_games$Date, x_ovi$Date))
ovi_potential_games %>%
filter(Date %in% setdiff(ovi_potential_games$Date, x_ovi$Date))
ovi_ppgs <- ovi_data_copy %>%
filter(Strength == "Power Play") %>%
group_by(Opponent) %>% f
ovi_ppgs <- ovi_data_copy %>%
filter(Strength == "Power Play") %>%
group_by(Opponent) %>%
summarise(num_ppgs = n())
View(ovi_ppgs)
ovi_ppgs <- ovi_ppgs[, -c(3, 24)]
ovi_ppgs <- ovi_ppgs[-c(3, 24),]
ovi_potential_games %>%
filter(Goals > 0) %>%
nrow()
View(ovi_potential_games)
ovi_model_set %>%
filter(Goals > 0) %>%
nrow()
test <- polr(Result ~ multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + ev_goals, data = ovi_model_set, Hess = TRUE)
exp(coef(test))
test <- lm(as.numeric(Result) ~ multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + ev_goals, data = ovi_model_set)
vif(test)
test <- polr(Result ~ multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + ev_goals, data = ovi_model_set)
brant(test)
test <- polr(Result ~ p1_goals + p2_goals + p3_goals + ot_goals + ev_goals, data = ovi_model_set)
brant(test)
exp(coef(test))
test <- polr(Result ~ p1_goals + p2_goals + p3_goals + ot_goals + ev_goals, data = ovi_model_set %>% filter(Goals > 0))
brant(test)
exp(coef(test))
test <- lm(as.numeric(Result) ~ multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + ev_goals, data = ovi_model_set %>% filter(Goals > 0))
vif(test)
test <- lm(as.numeric(Result) ~ as.numeric(HomeAway) + multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + ev_goals, data = ovi_model_set %>% filter(Goals > 0))
vif(test)
test <- lm(as.numeric(Result) ~ as.numeric(HomeAway) + Goals + multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + ev_goals, data = ovi_model_set %>% filter(Goals > 0))
vif(test)
test <- lm(as.numeric(Result) ~ as.numeric(HomeAway) + Goals + multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + ev_goals + pp_goals, data = ovi_model_set %>% filter(Goals > 0))
vif(test)
test <- lm(as.numeric(Result) ~ as.numeric(HomeAway) + multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + ev_goals + pp_goals, data = ovi_model_set %>% filter(Goals > 0))
vif(test)
test <- lm(as.numeric(Result) ~ as.numeric(HomeAway) + multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + ev_goals + pp_goals, data = ovi_model_set %>% filter(Goals == 0))
vif(test)
test <- lm(as.numeric(Result) ~ as.numeric(HomeAway) + multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + ev_goals, data = ovi_model_set %>% filter(Goals == 0))
vif(test)
test <- lm(as.numeric(Result) ~ multi_goals + ev_goals + pp_goals + sh_goals , data = ovi_model_set)
vif(test)
test <- lm(as.numeric(Result) ~ multi_goals + Goals + ev_goals + pp_goals + sh_goals , data = ovi_model_set)
vif(test)
test <- lm(as.numeric(Result) ~ multi_goals + ev_goals + pp_goals + sh_goals , data = ovi_model_set)
test <- polr(Result ~ multi_goals + ev_goals + pp_goals + sh_goals , data = ovi_model_set, Hess = TRUE)
brant(test)
test <- polr(Result ~ multi_goals + ev_goals + pp_goals + sh_goals , data = ovi_model_set %>% filter(Goals > 0), Hess = TRUE)
brant(test)
test <- polr(Result ~ multi_goals + p1_goals + p2_goals + p3_goals + ev_goals, data = ovi_model_set, Hess = TRUE)
brant(test)
test <- polr(Result ~ multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + ev_goals, data = ovi_model_set, Hess = TRUE)
brant(test)
exp(coef(test))
test <- lm(as.numeric(Result) ~ multi_goals + p1_goals + p2_goals + p3_goals + ot_goals + ev_goals, data = ovi_model_set, Hess = TRUE)
vif(test)
test <- lm(as.numeric(Result) ~ multi_goals + ev_goals + pp_goals + sh_goals, data = ovi_model_set, Hess = TRUE)
vif(test)
test <- polr(Result ~ multi_goals + ev_goals + pp_goals + sh_goals, data = ovi_model_set, Hess = TRUE)
brant(test)
test <- polr(Result ~ multi_goals + ev_goals + pp_goals + sh_goals, data = gretzky_model_set, Hess = TRUE)
brant(test)
exp(coef(test))
test <- polr(Result ~ Goals + multi_goals + ev_goals + pp_goals + sh_goals, data = gretzky_model_set, Hess = TRUE)
brant(test)
test <- polr(Result ~ multi_goals + ev_goals + pp_goals + sh_goals, data = ovi_model_set, Hess = TRUE)
exp(coef(test))
test <- polr(Result ~ multi_goals + p1_goals + p2_goals + p3_goals + ev_goals + pp_goals + sh_goals, data = ovi_model_set, Hess = TRUE)
brant(test)
test <- lm(as.numeric(Result) ~ multi_goals + p1_goals + p2_goals + p3_goals + ev_goals + pp_goals + sh_goals, data = ovi_model_set, Hess = TRUE)
vif(test)
test <- polr(Result ~ multi_goals + p1_goals + p2_goals + p3_goals + ev_goals + pp_goals + sh_goals, data = ovi_model_set, Hess = TRUE)
exp(coef(test))
View(gretzky_model_set)
install.packages("rvest")
install.packages("rvest")
knitr::opts_chunk$set(echo = TRUE)
library(rvest)
install.packages("rlang")
install.packages("rlang")
library(rvest)
install.packages("rvest")
library(rvest)
library(rvest)
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
knitr::opts_chunk$set(echo = TRUE)
document <- read_html("https://scrapeme.live/shop")
